# Vibe Coding Team 整合改进计划

> 本文档记录将 Superpowers 工程化流程与 Skills 技术规范整合到当前项目的详细计划。

---

## 核心改进理念

### 从描述性到工程化

**当前状态**：Agent 是"角色描述"，告诉用户"这个 Agent 能做什么"
**目标状态**：Agent 是"可执行流程"，告诉系统"如何一步步完成工作"

### 引入的铁律 (Iron Laws)

```
┌─────────────────────────────────────────────────────────────┐
│ 铁律 1: 没有设计验证，不开始编码                              │
│ 铁律 2: 没有详细计划，不开始实现                              │
│ 铁律 3: 没有失败的测试，不写生产代码                          │
│ 铁律 4: 没有根因分析，不尝试修复                              │
│ 铁律 5: 没有双阶段审查，不标记任务完成                        │
└─────────────────────────────────────────────────────────────┘
```

---

## 新工作流程架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        VIBE CODING WORKFLOW 2.0                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  PHASE 1: 设计阶段 (Design Phase)                                            │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ [vibe-architect] 激活 brainstorming 技能                              │   │
│  │   ├─ 苏格拉底式提问澄清需求                                            │   │
│  │   ├─ 探索 2-3 种方案及权衡                                             │   │
│  │   ├─ 增量式展示设计 (200-300字/段)                                     │   │
│  │   └─ 生成设计文档: docs/plans/YYYY-MM-DD-<feature>-design.md          │   │
│  │                                                                      │   │
│  │ 用户确认设计 → 进入 Phase 2                                           │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              ↓                                              │
│  PHASE 2: 准备阶段 (Preparation Phase)                                       │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ [vibe-architect] 激活 using-git-worktrees 技能                        │   │
│  │   ├─ 创建隔离工作区 (.worktrees/<branch>)                             │   │
│  │   ├─ 运行项目设置 (npm install, etc.)                                 │   │
│  │   └─ 验证干净基线 (所有测试通过)                                       │   │
│  │                                                                      │   │
│  │ [vibe-architect] 激活 writing-plans 技能                              │   │
│  │   ├─ 将设计拆分为 2-5 分钟粒度的任务                                   │   │
│  │   ├─ 每个任务: 精确文件路径 + 完整代码 + 测试命令                      │   │
│  │   └─ 生成计划文档: docs/plans/YYYY-MM-DD-<feature>-plan.md            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              ↓                                              │
│  PHASE 3: 实现阶段 (Implementation Phase)                                    │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ 选择执行模式:                                                         │   │
│  │                                                                      │   │
│  │ 模式 A: 子代理驱动 (Subagent-Driven) - 当前会话                        │   │
│  │   ├─ 每个任务派遣新鲜子代理                                            │   │
│  │   ├─ 子代理遵循 TDD: 红 → 绿 → 重构                                   │   │
│  │   ├─ 两阶段审查: 规格符合性 → 代码质量                                 │   │
│  │   └─ 循环直到所有任务完成                                              │   │
│  │                                                                      │   │
│  │ 模式 B: 计划执行 (Executing-Plans) - 并行会话                          │   │
│  │   └─ 在独立会话中批量执行任务，人工检查点                              │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              ↓                                              │
│  PHASE 4: 质量阶段 (Quality Phase)                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ [vibe-reviewer] 最终代码审查                                          │   │
│  │   ├─ 对比原始计划验证完整性                                            │   │
│  │   ├─ 架构合规性检查                                                    │   │
│  │   └─ 生成审查报告                                                      │   │
│  │                                                                      │   │
│  │ [vibe-debugger] 系统化测试                                            │   │
│  │   ├─ 运行完整测试套件                                                  │   │
│  │   ├─ 边界条件验证                                                      │   │
│  │   └─ 性能基准测试                                                      │   │
│  │                                                                      │   │
│  │ [vibe-documenter] 文档同步                                            │   │
│  │   ├─ API 文档生成                                                      │   │
│  │   ├─ 架构决策记录更新                                                  │   │
│  │   └─ 使用手册编写                                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              ↓                                              │
│  PHASE 5: 交付阶段 (Delivery Phase)                                          │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │ [vibe-architect] 激活 finishing-a-development-branch 技能             │   │
│  │   ├─ 验证所有任务完成                                                  │   │
│  │   ├─ 最终测试确认                                                      │   │
│  │   ├─ 提供交付选项: 合并/PR/保留/废弃                                   │   │
│  │   └─ 清理工作区                                                        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                              ↓                                              │
│                           交付完成                                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Agent 角色升级

### vibe-architect (架构指挥官) - 升级

**新增能力：**
- **Brainstorming 模式**: 需求澄清和方案探索
- **Worktree 管理**: 隔离工作区创建
- **计划编写**: 详细实施计划生成
- **流程协调**: 管理整个五阶段流程

**触发方式升级：**
```bash
# 旧方式 (仍然支持)
[vibe-architect] 设计一个用户认证系统

# 新方式 - 完整项目流程
[vibe-coding] 我需要开发一个电商平台，包含...
# 自动触发五阶段流程

# 新方式 - 仅从设计开始
[vibe-coding:design] 我想做一个任务管理应用
# 仅触发 Phase 1

# 新方式 - 从计划开始
[vibe-coding:plan] 基于 docs/plans/xxx-design.md 创建实施计划
# 触发 Phase 2
```

### vibe-coder (编码乐手) - 升级

**新增铁律：**
```
┌────────────────────────────────────────┐
│ TDD 铁律                                │
│ 1. 先写测试 (RED)                       │
│ 2. 运行看失败 (Verify RED)              │
│ 3. 写最小代码通过 (GREEN)               │
│ 4. 运行看通过 (Verify GREEN)            │
│ 5. 重构 (REFACTOR)                      │
│ 6. 保持绿色 (Stay GREEN)                │
│ 7. 提交 (COMMIT)                        │
└────────────────────────────────────────┘
```

**技术栈专精** (来自 Skills 库):
- 前端: React/Vue/Angular 组件分层
- 后端: RESTful API 设计、分层架构
- 数据库: 模型设计、查询优化

### vibe-reviewer (质量守门人) - 升级

**新增双阶段审查：**

**阶段 1: 规格符合性审查 (Spec Compliance)**
- 是否实现了计划中的所有要求？
- 是否有过度实现 (违反 YAGNI)？
- 是否遗漏了边界情况？

**阶段 2: 代码质量审查 (Code Quality)**
- 测试覆盖率
- 代码风格和命名
- 安全漏洞扫描
- 性能影响评估

### vibe-debugger (调试专家) - 升级

**新增系统化调试流程：**
```
Phase 1: 根因调查
  ├─ 仔细阅读错误信息
  ├─ 稳定复现问题
  ├─ 检查近期变更
  └─ 追踪数据流

Phase 2: 模式分析
  ├─ 寻找类似的成功代码
  ├─ 对比参考实现
  └─ 识别差异点

Phase 3: 假设与验证
  ├─ 形成单一假设
  ├─ 最小化测试
  └─ 验证或形成新假设

Phase 4: 实施修复
  ├─ 创建失败测试
  ├─ 实施单一修复
  └─ 验证修复有效
```

### vibe-documenter (文档生成器) - 轻微调整

**新增职责：**
- 设计文档维护
- 计划文档同步更新
- 决策记录 (ADR) 生成

---

## 质量门禁系统

### Level 1: 设计质量门禁
```yaml
检查项:
  - [ ] 需求澄清完成 (至少3轮问答)
  - [ ] 2-3种方案已探索
  - [ ] 架构图已绘制
  - [ ] 用户已确认设计
```

### Level 2: 计划质量门禁
```yaml
检查项:
  - [ ] 任务粒度 2-5 分钟
  - [ ] 每个任务有精确文件路径
  - [ ] 每个任务有完整代码示例
  - [ ] 每个任务有验证命令
  - [ ] 依赖关系清晰
```

### Level 3: 代码质量门禁
```yaml
检查项:
  - [ ] 所有新功能有先失败的测试
  - [ ] 所有测试通过
  - [ ] 无 console.error/warning
  - [ ] 代码风格一致
  - [ ] 安全扫描通过
```

### Level 4: 集成质量门禁
```yaml
检查项:
  - [ ] 完整测试套件通过
  - [ ] 与其他模块兼容
  - [ ] 性能基准达标
  - [ ] 文档已更新
```

---

## 文件结构变更

```
vibe-coding-team/
├── SKILL.md                    # 升级: 核心配置 + 流程触发
├── README.md                   # 更新: 新能力说明
├── INTEGRATION_PLAN.md         # 新增: 本文件
├── workflows/                  # 新增: 详细工作流程
│   ├── workflow-overview.md    # 五阶段流程总览
│   ├── phase-1-design.md       # 设计阶段详细流程
│   ├── phase-2-preparation.md  # 准备阶段详细流程
│   ├── phase-3-implementation.md # 实现阶段详细流程
│   ├── phase-4-quality.md      # 质量阶段详细流程
│   └── phase-5-delivery.md     # 交付阶段详细流程
├── agents/                     # 新增: Agent 详细定义
│   ├── vibe-architect.md       # 架构指挥官详细定义
│   ├── vibe-coder.md           # 编码乐手详细定义
│   ├── vibe-reviewer.md        # 质量守门人详细定义
│   ├── vibe-debugger.md        # 调试专家详细定义
│   └── vibe-documenter.md      # 文档生成器详细定义
├── quality-gates.md            # 新增: 质量门禁定义
├── principles.md               # 新增: 核心原则与铁律
└── examples/                   # 更新: 新流程示例
    └── engineering-workflow/   # 新增: 工程化流程示例
```

---

## 实施路线图

### Phase 1: 核心文档 (本周)
- [x] 创建 INTEGRATION_PLAN.md
- [ ] 重构 SKILL.md
- [ ] 创建 principles.md
- [ ] 创建 quality-gates.md

### Phase 2: 工作流程 (下周)
- [ ] 创建 workflows/ 目录和文件
- [ ] 创建 agents/ 目录和文件
- [ ] 更新 QUICK_REFERENCE.md

### Phase 3: 示例与验证 (第3周)
- [ ] 创建 engineering-workflow 示例
- [ ] 更新现有示例
- [ ] 验证流程可行性

### Phase 4: 文档完善 (第4周)
- [ ] 更新 README.md
- [ ] 更新 CHANGELOG.md
- [ ] 创建迁移指南

---

## 关键改进点对比

| 方面 | 当前 (v1.1) | 升级后 (v2.0) |
|------|-------------|---------------|
| **流程起点** | 直接编码 | 设计验证先行 |
| **任务粒度** | 描述性 | 2-5分钟可执行单元 |
| **开发环境** | 当前目录 | 隔离工作区 (Worktree) |
| **测试要求** | 建议 | TDD 铁律强制执行 |
| **代码审查** | 单阶段 | 双阶段 (规格→质量) |
| **调试方法** | 经验性 | 四阶段系统化 |
| **交付标准** | 模糊 | 四级质量门禁 |

---

## 与 Superpowers 的关系

**不是替代，是增强：**

- Superpowers 是"通用软件开发流程"
- Vibe Coding Team 是"AI Agent 协作框架"

**整合方式：**
- Vibe Coding Team 的每个 Agent 都可以调用 Superpowers 技能
- `[vibe-coding]` 触发词启动完整流程
- 内部自动调用相应的 Superpowers 技能

---

**最后更新**: 2026-01-30
**版本**: v2.0 规划
